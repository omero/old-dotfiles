# for this to work you must configure sudo such that
# it will be able to run the command without password

yabai -m signal --add event=dock_did_restart action="sudo yabai --load-sa"
sudo yabai --load-sa


yabai -m signal --add event=window_focused action="sketchybar --trigger window_focus"
yabai -m signal --add event=window_created action="sketchybar --trigger windows_on_spaces"
yabai -m signal --add event=window_destroyed action="sketchybar --trigger windows_on_spaces"


BAR_HEIGHT=$(sketchybar -m --query bar | jq -r '.height')


GENERAL=(
	external_bar all:"${BAR_HEIGHT}":0
	split_type auto
	split_ratio 0.5
	auto_balance off
	insert_feedback_color 0xff7793d1
)


WINDOWS=(
	window_placement first_child
	window_topmost on
	window_shadow float
	window_opacity on
	active_window_opacity 1.0
	normal_window_opacity 0.9
	window_animation_duration 0.0
	window_origin_display focused
	window_opacity_duration 0.15
)

LAYOUT=(
	layout bsp
	top_padding 20
	bottom_padding 20
	left_padding 20
	right_padding 20
	window_gap 20
)

MOUSE=(
	# set mouse interaction modifier key (default: fn)
	mouse_follows_focus on
	# set mouse interaction modifier key (default: fn)
	mouse_modifier alt
	# set modifier + left-click drag to move window (default: move)
	mouse_action1 move
	# set modifier + right-click drag to resize window (default: resize)
	mouse_action2 resize
)



yabai -m config "${GENERAL[@]}"
yabai -m config "${LAYOUT[@]}"
yabai -m config "${WINDOWS[@]}"
yabai -m config "${MOUSE[@]}"



# RULES
UNMANAGED=(
	Activity Monitor
	Alfred
	App Store
	Archive Utility
	Bitwarden
	Calculator
	Dictionary
	FaceTime
	# Finder
	Photo Booth
	Software Update
	Stats
	System Information
	System Preferences
	System Settings
	VLC
	zoom.us
)

for ((i = 1; i <= "${#UNMANAGED[@]}"; i++)); do
	yabai -m rule --add label="unmanage_${UNMANAGED[(($i - 1))]}" app="^${UNMANAGED[(($i - 1))]}.*$" manage=off border=off
done

